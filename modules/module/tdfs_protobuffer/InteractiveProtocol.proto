/////////////////////////////////////////////////
//作者：尹宾
//日期：2016-11-25
//内容：初步完成协议框架定义。
//版本：1.0.0
//
//修订：尹宾
//日期：2016-12-22
//修改内容：增加单独的用户查询和设备查询命令
//版本：1.0.1
//
//修订：尹宾
//日期：2017-2-13
//修改内容：完善设备相关命令
//版本：1.0.2
/////////////////////////////////////////////////

///////////////传输协议格式介绍//////////////////
//    __   ____   ____   ______   ____   ______   ______
//   |RG|,|长度|,|源端|,|目标端|,|类型|,|协议体|,|校验和|
//   ￣￣  ￣￣   ￣￣   ￣￣￣   ￣￣   ￣￣￣   ￣￣￣   
//长度：  该值为“源端,目标端,类型,协议体,校验和”的字节数，不包括长度字段后面的逗号。
//源端：  该值为消息传输投递的源头，代表发送消息自身实体，可以唯一表示源端。
//目标端：该值为消息传输投递的目标，代表接收消息实体，一般都需要实现约定好。
//类型：  该值为消息的具体业务类型，目前该值填写0.
//协议体：该值为业务协议的具体内容，就是下面采用protobuffer协议序列化后形成的字节缓冲区，支持Base64编码。
//校验和：该值为“源端,目标端,类型, 协议体”的crc16计算得出的值。
/////////////////////////////////////////////////

///////////////传输协议会话ID解析////////////////
//传输客户端在发起链接时，需要首先与服务器进行一次交互通信，以便获取当前这次链接的会话ID来进行通信，具体解析步骤如下：
//  1：客户端发起链接，按照前述的“传输协议格式”，源端为客户端ID，目标端为0，类型为0，协议体内容如下，来发送消息到服务端。
//     {"ID":"XXX","PWD":"XXX"} 注意：目前该内容服务器段暂未使用，所以客户端可以填写任意值。
//  2：客户端接受响应报文，Decode64处理之后，获得一个json格式字符串，在root节点处解析Key值为UUID的Value，该值就是这次传输
//     链接的会话ID值。
//  3：后续客户端在这次链接中进行消息发送，包装传输协议格式时，“源端”这个值就是会话ID值。
/////////////////////////////////////////////////


//Explicit 'optional' labels are disallowed in the Proto3 syntax. 
//To define 'optional' fields in Proto3, simply remove the 'optional' label, as fields are 'optional' by default.

syntax = "proto3"; 

package Interactive.Message;

enum MsgType
{
  Init_T = 0;
  GetAccessAddressReq_DEV_T = 10000; //设备获取接入服务器地址
  GetAccessAddressRsp_DEV_T = 10010;
  LoginReq_DEV_T = 10020;            //设备登录接入管理服务器
  LoginRsp_DEV_T = 10030; 
  LogoutReq_DEV_T = 10040;           //设备登出接入管理服务器
  LogoutRsp_DEV_T = 10050;  
  ShakehandReq_DEV_T = 10060;        //设备与接入管理服务器握手
  ShakehandRsp_DEV_T = 10070;  
  ConfigInfoReq_DEV_T = 10080;       //设备请求配置信息
  ConfigInfoRsp_DEV_T = 10090;
  
  StorageAddressReq_DEV_T = 10100;   //设备获取存储的地址
  StorageAddressRsp_DEV_T = 10110;
  
  P2pInfoReq_DEV_T = 10220;          //P2P服务器信息
  P2pInfoRsp_DEV_T = 10230;
  
  AddFileReq_DEV_T = 10300;          //设备添加文件
  AddFileRsp_DEV_T = 10310;
  
  QueryTimeZoneReq_DEV_T = 10320;    //查询时区
  QueryTimeZoneRsp_DEV_T = 10330;

  QueryAccessDomainNameReq_DEV_T = 10340;  //设备查询接入服务器域名
  QueryAccessDomainNameRsp_DEV_T = 10350;

  QueryUpgradeSiteReq_DEV_T = 10360;       //设备查询升级站点
  QueryUpgradeSiteRsp_DEV_T = 10370;

  QueryFirmwareUpgradeReq_DEV_T = 10380;   //设备查询升级版本数据
  QueryFirmwareUpgradeRsp_DEV_T = 10390;

  ////////////////////////////////////////////////////////
  
  MsgPreHandlerReq_USR_T = 19990;    //消息预处理
  MsgPreHandlerRsp_USR_T = 19991;    
  GetAccessAddressReq_USR_T = 20000; //用户获取用户设备管理服务器地址
  GetAccessAddressRsp_USR_T = 20010;
  RegisterUserReq_USR_T = 20020;     //用户注册
  RegisterUserRsp_USR_T = 20030;
  UnRegisterUserReq_USR_T = 20040;   //用户注销
  UnRegisterUserRsp_USR_T = 20050;
  QueryUsrInfoReq_USR_T = 20051;     //用户查询
  QueryUsrInfoRsp_USR_T = 20052;
  ModifyUserInfoReq_USR_T = 20055;   //用户修改
  ModifyUserInfoRsp_USR_T = 20056;
  RetrievePwdReq_USR_T = 20057;      //用户取回密码
  RetrievePwdRsp_USR_T = 20058;
  LoginReq_USR_T = 20060;            //用户登录用户设备管理服务器
  LoginRsp_USR_T = 20070; 
  LogoutReq_USR_T = 20080;           //用户登出用户设备管理服务器
  LogoutRsp_USR_T = 20090;  
  ShakehandReq_USR_T = 20100;        //用户与用户设备管理服务器握手
  ShakehandRsp_USR_T = 20110;  
  ConfigInfoReq_USR_T = 20120;       //用户请求配置信息
  ConfigInfoRsp_USR_T = 20130;
  
  AddDevReq_USR_T = 20140;           //用户添加设备
  AddDevRsp_USR_T = 20150;
  DelDevReq_USR_T = 20160;           //用户删除设备
  DelDevRsp_USR_T = 20170;
  ModifyDevReq_USR_T = 20180;        //用户修改设备
  ModifyDevRsp_USR_T = 20190;
  QueryDevInfoReq_USR_T = 20191;     //用户查询设备
  QueryDevInfoRsp_USR_T = 20192;
  QueryDevReq_USR_T = 20200;         //用户查询设备关系
  QueryDevRsp_USR_T = 20210;  
  QueryUserReq_USR_T = 20211;        //设备相关用户
  QueryUserRsp_USR_T = 20212;
  SharingDevReq_USR_T = 20220;       //用户共享设备
  SharingDevRsp_USR_T = 20230;
  CancelSharedDevReq_USR_T = 20240;  //用户取消共享设备
  CancelSharedDevRsp_USR_T = 20250;
  
  AddFriendsReq_USR_T = 20260;       //用户添加好友
  AddFriendsRsp_USR_T = 20270;
  DelFriendsReq_USR_T = 20280;       //用户删除好友
  DelFriendsRsp_USR_T = 20290;
  ModifyFriendsReq_USR_T = 20300;    //用户修改好友，目前暂不实现
  ModifyFriendsRsp_USR_T = 20310;
  QueryFriendsReq_USR_T = 20320;     //用户查询好友
  QueryFriendsRsp_USR_T = 20330;
  
  StorageAddressReq_USR_T = 20340;   //设备获取存储的地址
  StorageAddressRsp_USR_T = 20350;
  
  P2pInfoReq_USR_T = 20360;          //P2P服务器信息
  P2pInfoRsp_USR_T = 20370;
  
  DeleteFileReq_USR_T = 20500;       //用户删除文件
  DeleteFileRsp_USR_T = 20510;
  DownloadFileReq_USR_T = 20520;     //用户下载文件
  DownloadFileRsp_USR_T = 20530;
  QueryFileReq_USR_T = 20540;        //用户查询文件
  QueryFileRsp_USR_T = 20550;

  QueryAccessDomainNameReq_USR_T = 20600;       //用户查询接入服务器域名
  QueryAccessDomainNameRsp_USR_T = 20610;
  
  QueryAppUpgradeReq_USR_T = 20620;             //用户查询升级版本数据
  QueryAppUpgradeRsp_USR_T = 20630;

  ///////////////////////////////////////////////////////
  
  GetOnlineDevInfoReq_INNER_T = 30000;          //获取在线设备信息
  GetOnlineDevInfoRsp_INNER_T = 30010;
  BroadcastOnlineDevInfo_INNER_T = 30020;       //广播在线设备信息
  GetOnlineUserInfoReq_INNER_T = 30030;         //获取在线用户信息
  GetOnlineUserInfoRsp_INNER_T = 30040;
  BroadcastOnlineUserInfo_INNER_T = 30050;      //广播在线用户信息
  
  GetDeviceAccessRecordReq_INNER_T = 30200;     //获取设备接入记录
  GetDeviceAccessRecordRsp_INNER_T = 30210;
  GetUserAccessRecordReq_INNER_T = 30220;       //获取用户接入记录
  GetUserAccessRecordRsp_INNER_T = 30230;
  
  ///////////////////////////////////////////////////////

  QueryUploadURLReq_MGR_T = 40000;              //查询文件上传URL
  QueryUploadURLRsp_MGR_T = 40010;

  AddConfigurationReq_MGR_T = 40020;            //添加配置项
  AddConfigurationRsp_MGR_T = 40030;
  DeleteConfigurationReq_MGR_T = 40040;         //删除配置项
  DeleteConfigurationRsp_MGR_T = 40050;
  ModifyConfigurationReq_MGR_T = 40060;         //修改配置项
  ModifyConfigurationRsp_MGR_T = 40070;
  QueryAllConfigurationReq_MGR_T = 40080;       //查询所有配置项
  QueryAllConfigurationRsp_MGR_T = 40090;
}

message PermissionOfUser                        //用户权限对象
{
  uint32 uiUnlimited = 1;
  uint32 uiWatch = 2;    
}

message Device                                  //设备信息对象
{
  string strDevID = 1;
  string strDevName = 2;
  string strDevPassword = 3;
  uint32 uiTypeInfo = 4;
  string strCreatedate = 5;
  uint32 uiStatus = 6;
  string strExtend = 7;
  string strInnerinfo = 8;                      //设备上传到平台的信息
  
}

message User                                    //用户信息对象
{
  string strUserID = 1;
  string strUserName = 2;
  string strUserPassword = 3;
  uint32 uiTypeInfo = 4;
  string strCreatedate = 5;
  uint32 uiStatus = 6;
  string strExtend = 7;
  string strAliasName = 8;                      //别名
  string strEmail = 9;                          //邮箱
  
}

message Relation                                //用户与设备关系（设备与用户关系）
{
  string strUserID = 1;
  string strDevID = 2;
  uint32 uiRelation = 3;                        //关系包括，拥有0、被分享1、分享中2、转移3
  string strBeginDate = 4;
  string strEndDate = 5;
  string strValue = 6;
}

message File                                    //文件信息
{
  string strFileID = 1;
  string strUserID = 2;
  string strDevID = 3;
  string strRemoteFileID = 4;                   //服务器文件ID，与fileid一一对应
  string strDownloadUrl = 5;                    //文件URL地址
  string strFileName = 6;
  string strSuffixName = 7;                     //文件后缀名称
  uint64 uiFileSize = 8;                        //文件大小，单位Byte
  uint32 uiBusinessType = 9;                    //文件业务类型
  string strFileCreatedate = 10;                //文件创建日期
  string strCreatedate = 11;                    //本条记录生成日期
  uint32 uiStatus = 12;                         //0正常，1永久删除，2回收站
  string strExtend = 13;  
}

message FileUrl                                 //文件下载URL地址
{
  string strFileID = 1;
  string strDownloadUrl = 2;
}

message DeviceAccessRecord                      //设备接入记录
{
  string strAccessID = 1;
  string strClusterID = 2;
  string strDeviceID = 3;
  string strDeviceName = 4;
  uint32 uiDeviceType = 5;
  string strLoginTime = 6;
  string strLogoutTime = 7;
  uint32 uiOnlineDuration = 8;
  string strCreateDate = 9;
  uint32 uiStatus = 10;
}

message UserAccessRecord                        //用户接入记录
{
  string strAccessID = 1;
  string strClusterID = 2;
  string strUserID = 3;
  string strUserName = 4;
  string strUserAliasname = 5;
  uint32 uiClientType = 6;
  string strLoginTime = 7;
  string strLogoutTime = 8;
  uint32 uiOnlineDuration = 9;
  string strCreateDate = 10;
  uint32 uiStatus = 11;
}

message Configuration                           //配置项内容
{
  string strCategory = 1;
  string strSubCategory = 2;
  string strLatestVersion = 3;
  string strDescription = 4;
  string strForceVersion = 5;
  string strServerAddress = 6;
  string strFileName = 7;
  string strFileID = 8;
  uint32 uiFileSize = 9;
  string strFilePath = 10;
  uint32 uiLeaseDuration = 11;
  string strUpdateDate = 12;
  uint32 uiStatus = 13;
  string strExtend = 14;
}



//////////////////////////////////////////////////////////////////////////////////////

message GetAccessAddressReq_DEV                 //分布式场景下用
{
  string strDevID = 1;
  string strValue = 2;
}

message GetAccessAddressRsp_DEV                 //分布式场景下用
{
  string strAccessAddress = 1;
  string strAccessPort = 2;
  string strValue = 3;
}

message LoginReq_DEV                            //设备登陆请求
{
  string strDevID = 1;
  string strPassword = 2;
  uint32 uiDeviceType = 3;
  string strValue = 4;
}

message LoginRsp_DEV                            //设备登陆响应
{
  string strValue = 2;
}

message LogoutReq_DEV                           //设备登出请求
{
  string strDevID = 1;
  string strValue = 2;
}

message LogoutRsp_DEV                           //设备登出响应
{
  string strValue = 1;
}

message ShakehandReq_DEV                        //设备握手请求
{
  string strDevID = 1;
  string strValue = 3;
}

message ShakehandRsp_DEV                        //设备握手响应
{
  string strValue = 1;
}

message ConfigInfoReq_DEV                       //设备配置信息请求
{
  string strDevID = 1;
  string strValue = 2;
}

message ConfigInfoRsp_DEV                       //设备配置信息响应
{
  string strConfigInfo = 1;                     //设备配置信息
  string strValue = 2;
}

message StorageAddressReq_DEV                   //设备获取存储的地址请求
{
  string strDevID = 1;
  uint32 uiStorageType = 2;                     //存储类型：0，日志；1，照片；2，视频；3，固件；4，证书
  uint32 uiStorageAction = 3;                   //存储动作：0，上传；1，下载
  string strFileID = 4;                         //文件ID，下载时提供
}

message StorageAddressRsp_DEV                   //设备获取存储的地址响应
{
  string strAddress = 1;                        //上传、下载时使用的地址
  uint32 uiPort = 2;
}

message P2pInfoReq_DEV                          //p2p服务器信息请求
{
  string strDevID = 1;
  string strDevIpAddress = 2;  
}

message P2pInfoRsp_DEV                          //p2p服务器信息响应
{
  string strP2pServer = 1;
  string strP2pID = 2;
  uint32 uiLease = 3;                           //租约，单位为小时
  string strLicenseKey = 4;
  string strPushID = 5;
}

message AddFileReq_DEV                          //设备添加文件请求
{
  string strDevID = 1;
  repeated File fileInfo = 2;                   //支持批量添加文件
  string strValue = 3;
}

message AddFileRsp_DEV                          //设备添加文件响应
{
  string strValue = 1;
  repeated string strFileIDFailed = 2;          //添加失败的文件
}

message QueryTimeZoneReq_DEV                    //查询时区请求
{
  string strDevID = 1;
  string strDevIpAddress = 2;
}

message QueryTimeZoneRsp_DEV                    //查询时区响应
{
  string strCountryCode = 1;
  string strCountryNameEn = 2;
  string strCountryNameZh = 3;
  string strTimeZone = 4;
}

message QueryAccessDomainNameReq_DEV            //设备查询接入服务器域名请求
{
  string strDevIpAddress = 1;
  string strValue = 2;
}

message QueryAccessDomainNameRsp_DEV            //设备查询接入服务器域名响应
{
  string strDomainName = 1;
  uint32 uiLease = 2;
  string strValue = 3;
}

message QueryUpgradeSiteReq_DEV                 //设备查询升级站点请求
{
  string strDevID = 1;
  string strDevIpAddress = 2;
}

message QueryUpgradeSiteRsp_DEV                 //设备查询升级站点响应
{
  string strUpgradeSiteUrl = 1;
  uint32 uiLease = 2;                           //租约，单位为小时
}

message QueryFirmwareUpgradeReq_DEV             //设备查询升级数据请求
{
  string strCategory = 1;
  string strSubCategory = 2;
  string strCurrentVersion = 3;
}

message QueryFirmwareUpgradeRsp_DEV             //设备查询升级数据响应
{
  uint32 uiNewVersionValid = 1;                 //是否有新版本可用，0-否，1-是
  string strFirmwareName = 2;                   //固件名称
  string strFirmwarePath = 3;                   //固件路径
  uint32 uiFirmwareSize = 4;                    //固件文件大小，单位Byte
  string strVersion = 5;
  string strDescription = 6;
  uint32 uiForceUpgrade = 7;                    //是否要强制升级，0-否，1-是
  string strUpdateDate = 8;
}



////////////////////////////////////////////////////////

message MsgPreHandlerReq_USR                    //消息预处理，包括了一些通用的检查动作
{
  string strValue = 1;
}

message MsgPreHandlerRsp_USR                    //消息预处理响应，若是失败，则后续业务操作都全部终止
{
  string strValue = 1;
}

message GetAccessAddressReq_USR                 //分布式场景下用
{
  string strSerializeID = 1;                    
  string strValue = 2;
}

message GetAccessAddressRsp_USR                 //分布式场景下用
{
  string strAccessAddress = 1;
  string strAccessPort = 2;
  string strValue = 3;
}

message RegisterUserReq_USR                     //用户注册请求
{
  User userInfo = 1;
  string strValue = 2;
}

message RegisterUserRsp_USR                     //用户注册响应
{
  string strUserID = 1;                         //系统返回用户ID，这个ID后续用来代表用户的身份来进行后续的操作
  string strValue = 2;
}

message UnRegisterUserReq_USR                   //用户注销请求
{
  User userInfo = 1;
  string strValue = 2;
}

message UnRegisterUserRsp_USR                   //用户注销响应
{
  string strUserID = 1;
  string strValue = 2;  
}

message QueryUsrInfoReq_USR                     //查询用户信息请求
{
  string strUserID = 1;
  string strValue = 2;
}

message QueryUsrInfoRsp_USR                     //查询用户信息响应
{
  User userInfo = 1;
  string strValue = 2;
}

message ModifyUserInfoReq_USR                   //用户修改信息请求
{
  string strOldPwd = 1;
  User userInfo = 2;
}

message ModifyUserInfoRsp_USR                   //用户修改信息响应
{
  string strValue = 1;
}

message RetrievePwdReq_USR                      //找回密码请求
{
  string strUserName = 1;
  string strEmail = 2;
}

message RetrievePwdRsp_USR                      //找回密码响应
{
  string strValue = 1;
}


message LoginReq_USR                            //用户登录请求
{
  User userInfo = 1;
  uint32 uiTerminalType = 2;
  string strValue = 3;
}

message LoginRsp_USR                            //用户登录响应
{
  string strUserID = 1;                         //系统返回用户ID，这个ID后续用来代表用户的身份来进行后续的操作
  repeated Relation relationInfo = 2;           //这里直接返回用户与设备关联的信息，便于前端处理
  string strValue = 3;
  repeated string strDevName = 4;
}

message LogoutReq_USR                           //用户登出请求
{
  User userInfo = 1;
  string strValue = 2;
}

message LogoutRsp_USR                           //用户登出响应
{
  string strValue = 1;
}

message ShakehandReq_USR                        //用户与平台的握手请求，这里握手主要是用来对后台对应的Session进行保活处理
{
  string strUserID = 1;
  string strValue = 2;
}

message ShakehandRsp_USR                        //用户与平台的握手响应
{
  string strValue = 1;
}

message ConfigInfoReq_USR                       //用户配置信息请求
{
  string strUserID = 1;
  string strValue = 2;
}

message ConfigInfoRsp_USR                       //用户配置信息响应
{
  string strValue = 1;
  repeated string strItems = 2;
}


message AddDevReq_USR                           //添加设备请求，同时建立了用户与设备之间绑定关系
{
  string strUserID = 1;
  Device devInfo = 2;
  
}

message AddDevRsp_USR                           //添加设备响应。
{
  string strValue = 1;
}

message DelDevReq_USR                           //删除设备请求
{
  string strUserID = 1;
  repeated string strDevID = 2;                 //支持批量设备删除，这里增加、修改、查询都不支持单个命令批量处理，只有删除支持批量处理
}

message DelDevRsp_USR                           //删除设备响应
{
  string strValue = 1;
  repeated string strDevIDFailed = 2;           //考虑到批量删除设备，部分失败的情况。
}

message ModifyDevReq_USR                        //修改设备信息请求
{
  string strUserID = 1;
  Device devInfo = 2;
}

message ModifyDevRsp_USR                        //修改设备信息响应
{
  string strValue = 1;
}

message QueryDevInfoReq_USR                     //查询设备信息请求
{
  string strDevID = 1;
  string strValue = 2;
}

message QueryDevInfoRsp_USR                     //查询设备信息响应
{
  Device devInfo = 1;
  string strValue = 2;
}

message QueryDevReq_USR                         //查询用户关联设备的信息，这里要考虑到分页处理
{
  string strUserID = 1;
  uint32 uiBeginIndex = 2;
  string strValue = 3;
}

message QueryDevRsp_USR                         //查询用户关联设备响应，这里返回的是Relation对象，描述了用户与设备之间的关系。
{
  repeated Relation allRelationInfo = 1;      
  repeated string strDevName = 2;
}

message QueryUserReq_USR                        //查询设备关联的用户信息，这里要考虑分页处理
{
  string strDevID = 1;
  uint32 uiBeginIndex = 2;
  string strValue = 3;
}

message QueryUserRsp_USR                        //查询设备关联用户信息响应
{
  repeated Relation allRelationInfo = 1;
  repeated string strUserName = 2;
}

message SharingDevReq_USR                       //分享设备请求
{
  Relation relationInfo = 1;
  string strValue = 2;
}

message SharingDevRsp_USR                       //分享设备响应
{
  string strValue = 1;
}

message CancelSharedDevReq_USR                  //取消分享设备请求
{
  Relation relationInfo = 1;
  string strValue = 2;
}

message CancelSharedDevRsp_USR                  //取消分享设备响应
{
  string strValue = 1;  
}

message AddFriendsReq_USR                       //添加好友请求。好友关系只有增加、删除、查询，没有修改动作
{
  string strUserID = 1;
  string strFriendUserID = 2;
}

message AddFriendsRsp_USR                       //添加好友响应
{
  string strValue = 1;  
}

message DelFriendsReq_USR                       //删除好友请求，支持批量删除好友
{
  string strUserID = 1;
  repeated string strFriendUserID = 2;
}

message DelFriendsRsp_USR                       //删除好友响应
{
  string strValue = 1;
  repeated string strFriendUserIDFailed = 2;    //考虑到批量删除好友，部分失败的情况。
}

message QueryFriendsReq_USR                     //查询好友请求
{
  string strUserID = 1;
  uint32 uiBeginIndex = 2;
  string strValue = 3;
}

message QueryFriendsRsp_USR                     //查询好友响应
{
  repeated string strAllFriendUserID = 1;
}

message StorageAddressReq_USR                   //用户获取存储的地址请求
{
  string strUserID = 1;
  uint32 uiStorageType = 2;                     //存储类型：0，日志；1，照片；2，视频；3，固件；4，证书
  uint32 uiStorageAction = 3;                   //存储动作：0，上传；1，下载
  string strFileID = 4;                         //文件ID，下载时提供
}

message StorageAddressRsp_USR                   //设备获取存储的地址响应
{
  string strAddress = 1;                        //上传、下载时使用的地址
  uint32 uiPort = 2;
}

message P2pInfoReq_USR                          //p2p服务器信息请求
{
  string strUserID = 1;
  string strUserIpAddress = 2;
  string strDevID = 3;                          //用户希望链接的设备ID  
}

message P2pInfoRsp_USR                          //p2p服务器信息响应
{
  string strP2pServer = 1;
  string strP2pID = 2;
  uint32 uiLease = 3;                           //租约，单位为小时
  string strLicenseKey = 4;
  string strPushID = 5;
}
message DeleteFileReq_USR                       //用户删除文件请求
{
  string strUserID = 1;
  repeated string strFileID = 2;                //支持批量删除文件
}

message DeleteFileRsp_USR                       //用户删除文件响应
{
  string strValue = 1;
  repeated string strFileIDFailed = 2;          //删除失败的文件
}

message DownloadFileReq_USR                     //用户下载文件请求
{
  string strUserID = 1;
  repeated string strFileID = 2;                //支持批量下载文件
}

message DownloadFileRsp_USR                     //用户下载文件响应
{
  string strValue = 1;
  repeated FileUrl fileUrl = 2;                 //文件下载地址
}

//用户查询其存储的所有文件，考虑分页处理
message QueryFileReq_USR                        //用户查询文件请求
{
  string strUserID = 1;
  string strDevID = 2;
  uint32 uiBeginIndex = 3;
  string strBeginDate = 4;
  string strEndDate = 5;
  uint32 uiBusinessType = 6;
  string strValue = 7;
}

message QueryFileRsp_USR                        //用户查询文件响应
{
  string strValue = 1;
  repeated File fileInfo = 2;
}

message QueryAccessDomainNameReq_USR            //用户查询接入服务器域名请求
{
  string strUserIpAddress = 1;
  string strValue = 2;
}

message QueryAccessDomainNameRsp_USR            //用户查询接入服务器域名响应
{
  string strDomainName = 1;
  uint32 uiLease = 2;
  string strValue = 3;
}

message QueryAppUpgradeReq_USR                  //用户APP查询升级数据请求
{
  string strCategory = 1;
  string strSubCategory = 2;
  string strCurrentVersion = 3;
}

message QueryAppUpgradeRsp_USR                  //用户APP查询升级数据响应
{
  uint32 uiNewVersionValid = 1;                 //是否有新版本可用，0-否，1-是
  string strAppName = 2;                        //APP名称
  string strAppPath = 3;                        //APP路径
  uint32 uiAppSize = 4;                         //APP文件大小，单位Byte
  string strVersion = 5;
  string strDescription = 6;
  uint32 uiForceUpgrade = 7;                    //是否要强制升级，0-否，1-是
  string strUpdateDate = 8;
}



///////////////////////////////配置相关命令，目前固件和APP升级会使用/////////////////////////////////

message QueryUploadURLReq_MGR                   //查询文件上传URL请求
{
  string strValue = 1;
}

message QueryUploadURLRsp_MGR                   //查询文件上传URL响应
{
  string strUploadURL = 1;
}

message AddConfigurationReq_MGR                 //新增配置项请求
{
  Configuration configurationInfo = 1;
}

message AddConfigurationRsp_MGR                 //新增配置项响应
{
  string strValue = 1;
}

message DeleteConfigurationReq_MGR              //删除配置项请求
{
  string strCategory = 1;
  string strSubCategory = 2;
}

message DeleteConfigurationRsp_MGR              //删除配置项响应
{
  string strValue = 1;
}

message ModifyConfigurationReq_MGR              //修改配置项请求
{
  Configuration configurationInfo = 1;
}

message ModifyConfigurationRsp_MGR              //修改配置项响应
{
  string strValue = 1;
}

message QueryAllConfigurationReq_MGR            //查询所有配置项请求
{
  uint32 uiBeginIndex = 1;
}

message QueryAllConfigurationRsp_MGR            //查询所有配置项响应
{
  repeated Configuration configurationInfo = 1;
}



////////////////////////////////////////////////下面这些都是一些通知、广播类的消息///////////////////

message GetOnlineDevInfoReq_INNER               
{
  string strValue = 1;
}

message GetOnlineDevInfoRsp_INNER
{
  repeated Device devInfo = 1;
  string strValue = 2;
}

message BroadcastOnlineDevInfo_INNER
{
  repeated Device devInfo = 1;
  string strValue = 2;
}

message GetOnlineUserInfoReq_INNER
{
  string strValue = 1;
}

message GetOnlineUserInfoRsp_INNER
{
  repeated User userInfo = 1;
  string strValue = 2;
}

message BroadcastOnlineUserInfo_INNER
{  
  repeated User userInfo = 1;
  string strValue = 2;
}

message GetDeviceAccessRecordReq_INNER          //获取设备接入记录请求
{
  uint32 uiBeginIndex = 1;
}

message GetDeviceAccessRecordRsp_INNER          //获取设备接入记录响应
{
  repeated DeviceAccessRecord deviceAccessRecord = 1;
  uint32 uiRecordTotal = 2;
}

message GetUserAccessRecordReq_INNER            //获取用户接入记录请求
{
  uint32 uiBeginIndex = 1;
}

message GetUserAccessRecordRsp_INNER            //获取用户接入记录响应
{
  repeated UserAccessRecord userAccessRecord = 1;
  uint32 uiRecordTotal = 2;
}



/////////////////////////////////////////////////////////////////////////////////////////////////////////////

//请求对象
message Req
{
  GetAccessAddressReq_DEV GetAccessAddressReq_DEV_Value = 10;      //设备获取接入服务器地址 
  LoginReq_DEV LoginReq_DEV_Value = 20;                            //设备登录接入管理服务器
  LogoutReq_DEV LogoutReq_DEV_Value = 30;                          //设备登出接入管理服务器
  ShakehandReq_DEV ShakehandReq_DEV_Value = 40;                    //设备与接入管理服务器握手
  ConfigInfoReq_DEV ConfigInfoReq_DEV_Value = 50;                  //设备请求配置信息
  
  StorageAddressReq_DEV StorageAddressReq_DEV_Value = 52;          //设备请求存储地址
  P2pInfoReq_DEV P2pInfoReq_DEV_Value = 54;                        //设备请求p2p服务器
  
  AddFileReq_DEV AddFileReq_DEV_Value = 60;                        //设备添加文件
  
  QueryTimeZoneReq_DEV QueryTimeZoneReq_DEV_Value = 61;            //查询时区
  QueryAccessDomainNameReq_DEV QueryAccessDomainNameReq_DEV_Value = 62;    //设备查询接入服务器域名

  QueryUpgradeSiteReq_DEV QueryUpgradeSiteReq_DEV_Value = 63;      //设备查询升级站点
  QueryFirmwareUpgradeReq_DEV QueryFirmwareUpgradeReq_DEV_Value = 64;      //设备查询升级版本数据

  ////////////////////////////////////////////////////////////////////////////////////////////////

  MsgPreHandlerReq_USR MsgPreHandlerReq_USR_Value = 65;            //消息预处理
  GetAccessAddressReq_USR GetAccessAddressReq_USR_Value = 70;      //用户获取用户设备管理服务器地址
  RegisterUserReq_USR RegisterUserReq_USR_Value = 80;              //用户注册
  UnRegisterUserReq_USR UnRegisterUserReq_USR_Value = 90;          //用户注销
  QueryUsrInfoReq_USR QueryUsrInfoReq_USR_Value = 100;             //用户查询
  ModifyUserInfoReq_USR ModifyUserInfoReq_USR_Value = 102;         //用户修改
  RetrievePwdReq_USR RetrievePwdReq_USR_Value = 104;               //用户取回密码
  LoginReq_USR LoginReq_USR_Value = 110;                           //用户登录用户设备管理服务器
  LogoutReq_USR LogoutReq_USR_Value = 120;                         //用户登出用户设备管理服务器
  ShakehandReq_USR ShakehandReq_USR_Value = 130;                   //用户与用户设备管理服务器握手
  ConfigInfoReq_USR ConfigInfoReq_USR_Value = 140;                 //用户请求配置信息
  
  AddDevReq_USR AddDevReq_USR_Value = 150;                         //用户添加设备
  DelDevReq_USR DelDevReq_USR_Value = 160;                         //用户删除设备
  ModifyDevReq_USR ModifyDevReq_USR_Value = 170;                   //用户修改设备
  QueryDevInfoReq_USR QueryDevInfoReq_USR_Value = 180;             //用户查询设备
  QueryDevReq_USR QueryDevReq_USR_Value = 190;                     //用户根据用户ID查看相关联的设备
  QueryUserReq_USR QueryUserReq_USR_Value = 200;                   //用户根据设备ID查看相关联的用户
  SharingDevReq_USR SharingDevReq_USR_Value = 210;                 //用户共享设备
  CancelSharedDevReq_USR CancelSharedDevReq_USR_Value = 220;       //用户取消共享设备
  
  AddFriendsReq_USR AddFriendsReq_USR_Value = 230;                 //用户添加好友
  DelFriendsReq_USR DelFriendsReq_USR_Value = 240;                 //用户删除好友
  QueryFriendsReq_USR QueryFriendsReq_USR_Value = 250;             //用户查询好友
  
  StorageAddressReq_USR StorageAddressReq_USR_Value = 252;         //用户请求存储地址
  P2pInfoReq_USR P2pInfoReq_USR_Value = 254;                       //用户请求p2p服务器

  DeleteFileReq_USR DeleteFileReq_USR_Value = 310;                 //用户删除文件
  DownloadFileReq_USR DownloadFileReq_USR_Value = 320;             //用户下载文件
  QueryFileReq_USR QueryFileReq_USR_Value = 330;                   //用户查询文件
  
  QueryAccessDomainNameReq_USR QueryAccessDomainNameReq_USR_Value = 350;   //用户查询接入服务器域名

  QueryAppUpgradeReq_USR QueryAppUpgradeReq_USR_Value = 360;     //用户查询升级版本数据

  ////////////////////////////////////////////////////////////////////////////////////////////////

  GetOnlineDevInfoReq_INNER GetOnlineDevInfoReq_INNER_Value = 260;            //获取在线设备信息
  BroadcastOnlineDevInfo_INNER BroadcastOnlineDevInfo_INNER_Value = 270;      //广播在线设备信息
  GetOnlineUserInfoReq_INNER GetOnlineUserInfoReq_INNER_Value = 280;          //获取在线用户信息
  BroadcastOnlineUserInfo_INNER BroadcastOnlineUserInfo_INNER_Value = 290;    //广播在线用户信息

  GetDeviceAccessRecordReq_INNER GetDeviceAccessRecordReq_INNER_Value = 440;  //获取设备接入记录
  GetUserAccessRecordReq_INNER GetUserAccessRecordReq_INNER_Value = 450;      //获取用户接入记录
  
  QueryUploadURLReq_MGR QueryUploadURLReq_MGR_Value = 600;                    //查询文件上传URL
  
  AddConfigurationReq_MGR AddConfigurationReq_MGR_Value = 610;                //新增配置项
  DeleteConfigurationReq_MGR DeleteConfigurationReq_MGR_Value = 620;          //删除配置项
  ModifyConfigurationReq_MGR ModifyConfigurationReq_MGR_Value = 630;          //修改配置项
  QueryAllConfigurationReq_MGR QueryAllConfigurationReq_MGR_Value = 640;      //查询所有配置项
}

//响应对象
message Rsp
{
  int32 iRetcode = 10;                                             //返回码
  string strRetMsg = 20;                                           //返回消息
  
  
  GetAccessAddressRsp_DEV GetAccessAddressRsp_DEV_Value = 30;      //设备获取接入服务器地址 
  LoginRsp_DEV LoginRsp_DEV_Value = 40;                            //设备登录接入管理服务器
  LogoutRsp_DEV LogoutRsp_DEV_Value = 50;                          //设备登出接入管理服务器
  ShakehandRsp_DEV ShakehandRsp_DEV_Value = 60;                    //设备与接入管理服务器握手
  ConfigInfoRsp_DEV ConfigInfoRsp_DEV_Value = 70;                  //设备请求配置信息
  
  StorageAddressRsp_DEV StorageAddressRsp_DEV_Value = 72;          //设备请求存储地址
  P2pInfoRsp_DEV P2pInfoRsp_DEV_Value = 74;                        //设备请求p2p服务器 
  
  AddFileRsp_DEV AddFileRsp_DEV_Value = 80;                        //设备添加文件
  
  QueryTimeZoneRsp_DEV QueryTimeZoneRsp_DEV_Value = 81;            //查询时区
  QueryAccessDomainNameRsp_DEV QueryAccessDomainNameRsp_DEV_Value = 82;   //设备查询接入服务器域名

  QueryUpgradeSiteRsp_DEV QueryUpgradeSiteRsp_DEV_Value = 83;      //设备查询升级站点
  QueryFirmwareUpgradeRsp_DEV QueryFirmwareUpgradeRsp_DEV_Value = 84;     //设备查询升级版本数据
 
 ////////////////////////////////////////////////////////////////////////////////////////////////

  MsgPreHandlerRsp_USR MsgPreHandlerRsp_USR_Value = 85;            //消息预处理
  GetAccessAddressRsp_USR GetAccessAddressRsp_USR_Value = 90;      //用户获取用户设备管理服务器地址
  RegisterUserRsp_USR RegisterUserRsp_USR_Value = 100;             //用户注册
  UnRegisterUserRsp_USR UnRegisterUserRsp_USR_Value = 110;         //用户注销
  QueryUsrInfoRsp_USR QueryUsrInfoRsp_USR_Value = 120;             //用户查询
  ModifyUserInfoRsp_USR ModifyUserInfoRsp_USR_Value = 122;         //用户修改
  RetrievePwdRsp_USR RetrievePwdRsp_USR_Value = 124;               //用户取回密码
  LoginRsp_USR LoginRsp_USR_Value = 130;                           //用户登录用户设备管理服务器
  LogoutRsp_USR LogoutRsp_USR_Value = 140;                         //用户登出用户设备管理服务器
  ShakehandRsp_USR ShakehandRsp_USR_Value = 150;                   //用户与用户设备管理服务器握手
  ConfigInfoRsp_USR ConfigInfoRsp_USR_Value = 160;                 //用户请求配置信息
  
  AddDevRsp_USR AddDevRsp_USR_Value = 170;                         //用户添加设备
  DelDevRsp_USR DelDevRsp_USR_Value = 180;                         //用户删除设备
  ModifyDevRsp_USR ModifyDevRsp_USR_Value = 190;                   //用户修改设备
  QueryDevInfoRsp_USR QueryDevInfoRsp_USR_Value = 200;             //用户查询设备
  QueryDevRsp_USR QueryDevRsp_USR_Value = 210;                     //用户根据用户ID查看相关联的设备
  QueryUserRsp_USR QueryUserRsp_USR_Value = 220;                   //用户根据设备ID查看相关联的用户
  SharingDevRsp_USR SharingDevRsp_USR_Value = 230;                 //用户共享设备
  CancelSharedDevRsp_USR CancelSharedDevRsp_USR_Value = 240;       //用户取消共享设备
  
  AddFriendsRsp_USR AddFriendsRsp_USR_Value = 250;                 //用户添加好友
  DelFriendsRsp_USR DelFriendsRsp_USR_Value = 260;                 //用户删除好友
  QueryFriendsRsp_USR QueryFriendsRsp_USR_Value = 270;             //用户查询好友
  
  StorageAddressRsp_USR StorageAddressReq_USR_Value = 272;         //用户请求存储地址
  P2pInfoRsp_USR P2pInfoRsp_USR_Value = 274;                       //用户请求p2p服务器

  DeleteFileRsp_USR DeleteFileRsp_USR_Value = 310;                 //用户删除文件
  DownloadFileRsp_USR DownloadFileRsp_USR_Value = 320;             //用户下载文件
  QueryFileRsp_USR QueryFileRsp_USR_Value = 330;                   //用户查询文件
  
  QueryAccessDomainNameRsp_USR QueryAccessDomainNameRsp_USR_Value = 350;   //用户查询接入服务器域名
  
  QueryAppUpgradeRsp_USR QueryAppUpgradeRsp_USR_Value = 360;       //用户查询升级版本数据

  ////////////////////////////////////////////////////////////////////////////////////////////////

  GetOnlineDevInfoRsp_INNER GetOnlineDevInfoRsp_INNER_Value = 280;   //获取在线设备信息
  GetOnlineUserInfoRsp_INNER GetOnlineUserInfoRsp_INNER_Value = 290; //获取在线用户信息

  GetDeviceAccessRecordRsp_INNER GetDeviceAccessRecordRsp_INNER_Value = 440;  //获取设备接入记录
  GetUserAccessRecordRsp_INNER GetUserAccessRecordRsp_INNER_Value = 450;      //获取用户接入记录

  ////////////////////////////////////////////////////////////////////////////////////////////////

  QueryUploadURLRsp_MGR QueryUploadURLRsp_MGR_Value = 600;                    //查询文件上传URL

  AddConfigurationRsp_MGR AddConfigurationRsp_MGR_Value = 610;                //新增配置项
  DeleteConfigurationRsp_MGR DeleteConfigurationRsp_MGR_Value = 620;          //删除配置项
  ModifyConfigurationRsp_MGR ModifyConfigurationRsp_MGR_Value = 630;          //修改配置项
  QueryAllConfigurationRsp_MGR QueryAllConfigurationRsp_MGR_Value = 640;      //查询所有配置项
}

//主消息对象，包括了请求、响应，根据消息类型的不同来进行对应的处理
message InteractiveMessage
{
  MsgType type = 1;        //消息类型
  uint64 uiMsgSeq = 2;     //消息序号
  string strSID = 3;       //会话ID
  Req ReqValue = 4;        //请求值
  Rsp RspValue = 5;        //响应值
}

